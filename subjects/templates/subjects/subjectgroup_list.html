{% extends "base.html" %}
{% block title %}گروه‌های مضامین{% endblock %}

{% block content %}
<div class="app-content">
  <div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="h5">📚 گروه‌های مضامین من</h2>
      <a href="{% url 'subjectgroup_create' %}" class="btn btn-primary btn-sm">
        <i class="bi bi-plus-circle"></i> افزودن گروه
      </a>
    </div>


    <div class="table-responsive">
      <table class="table table-sm table-striped table-hover table-bordered align-middle small">
        <thead class="table-dark">
          <tr>
            <th>شماره</th>
            <th>نام گروه</th>
            <th>مضامین</th>
            <th>توضیحات</th>
            <th>اقدامات</th>
          </tr>
        </thead>
        <tbody>
          {% for group in groups %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ group.name }}</td>
            <td>
              {% for subject in group.subjects.all %}
                {{ subject.name }}{% if not forloop.last %}, {% endif %}
              {% empty %}
                ❌ هیچ مضمونی ندارد
              {% endfor %}
            </td>
            <td>{{ group.description }}</td>
            <td>
              {% if group.created_by == request.user %}
                <a href="{% url 'subjectgroup_update' group.pk %}" class="btn btn-sm btn-warning mb-1">
                  <i class="bi bi-pencil-square"></i> ویرایش
                </a>
                <a href="{% url 'subjectgroup_delete' group.pk %}" class="btn btn-sm btn-danger mb-1">
                  <i class="bi bi-trash"></i> حذف
                </a>
              {% else %}
                <span class="text-muted small">🔒 قابل ویرایش نیست</span>
              {% endif %}
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center">❌ هیچ گروهی ثبت نشده</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <a href="{% url 'home' %}" class="btn btn-secondary btn-sm mt-3">
      <i class="bi bi-arrow-left-circle"></i> بازگشت به داشبورد
    </a>
  </div>
</div>
{% endblock %}
